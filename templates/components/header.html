{% load static %}

<link rel="stylesheet" href="{% static 'css/header.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<link rel="stylesheet" href="{% static 'css/modal.css' %}">
<header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
      <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"/></svg>
      <span class="fs-4">BARAKA</span>
    </a>
    <div id="modal" class="modal">
      <div class="modal-content">
        <div class="control-items">
          <span class="close">&times;</span>
        </div>
        <h3>Вы можете изменить салон при помощи выпадающего списка</h3>
        <div class="salon-text">
          <p>Адресс салона: <strong>{{request.session.salon.address}}</strong></p>
        </div>
        <div class="map">
          <div id="map"></div>
        </div>
        <form method="post" action="{% url 'select_salon' %}">
          {% csrf_token %}
          <select class="form-control" name="salon_pk" onchange="this.form.submit()">
              <option >Наши салоны</option>
              {% for salon in salons %}
                  <option value="{{ salon.pk }}" {% if salon.pk == request.session.salon.pk %}selected{% endif %}>
                      {{ salon.name }}
                  </option>
              {% endfor %}
          </select>
      </form>
      </div>
    </div>

    
    <ul class="nav nav-pills">
      <li class="nav-item"><button class="nav-link" id="openModalBtn">{% if request.session.salon.name %}{{request.session.salon.name}}{% else %}Выберите салон{% endif %}</button></li>
      <li class="nav-item"><a href="{% url 'home' %}" class="nav-link" aria-current="page">Главная</a></li>
      <li class="nav-item"><a href="{% url 'home' %}" class="nav-link">Мастера</a></li>
      <li class="nav-item"><a href="{% url 'about' %}" class="nav-link">О нас</a></li>
      <li class="nav-item"><a href="{% url 'clear' %}" class="nav-link">Очистить сессию</a></li>
    </ul>
</header>
<script src="{% static 'js/modal.js' %}"></script>


<script>
  ymaps.ready(init);
  function init() {
      var myMap = new ymaps.Map("map", {
        center: [{{ request.session.salon.latitude }}, {{ request.session.salon.longitude }}],
        zoom: 15,
        controls: [ 'fullscreenControl'],
        zoomRange: [10,15]
      });

      var myPlacemark = new ymaps.Placemark([{{ request.session.salon.latitude }}, {{ request.session.salon.longitude }}], {
          hintContent: 'Содержимое всплывающей подсказки',
          balloonContent: 'Содержимое балуна'
      });
      
      myMap.geoObjects.add(myPlacemark);
  }
</script>

<style>
  .map {
    display: flex;
    justify-content: center;
  }
  #map {
    width: 600px;
    height: 400px;
  }
</style>